---
- name: Show NTP settings from Cisco devices
  hosts: cisco
  gather_facts: no

  tasks:
    - name: Gather Cisco facts
      ios_facts:

    - name: Print Cisco hostname
      debug:
        var: ansible_net_hostname

    - name: Print Cisco NTP servers
      debug:
        var: ansible_net_ntp

- name: Check NTP configuration on Palo Alto device
  hosts: paloalto
  gather_facts: no

  vars:
    device:
      ip_address: "{{ ansible_host }}"
      username: "{{ ansible_user }}"
      password: "{{ ansible_password }}"

  tasks:
    - name: Get current NTP configuration from Palo Alto
      paloaltonetworks.panos.panos_op:
        provider: "{{ device }}"
        cmd: "show ntp"
      register: ntp_output
    
    - name: Print configured NTP servers
      debug:
        var: ntp_output.stdout
    - name: Print configured NTP server names from Palo Alto
      debug:
        msg:
          - "NTP Server 1: {{ ntp_output.stdout['response']['result']['ntp-server-1']['name'] }}"
          - "NTP Server 2: {{ ntp_output.stdout['response']['result']['ntp-server-2']['name'] }}"
      when: ntp_output.stdout['response']['result'] is defined